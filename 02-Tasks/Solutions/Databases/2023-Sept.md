# Задача 1:
```sql
SELECT starname
FROM STARSIN
JOIN MOVIESTAR ON STARSIN.starname = MOVIESTAR.name
WHERE GENDER = 'F' AND year <= 2000
INTERSECT
SELECT starname
FROM STARSIN
JOIN MOVIESTAR ON STARSIN.starname = MOVIESTAR.name
WHERE GENDER = 'F' AND year >= 2001;
```

# Задача 2:
Отговор В за верен.

## Oбосновка за другите
За Г)
```sql
SELECT DISTINCT studioname
FROM Movie m
WHERE (SELECT SUM(length)
        FROM Movie
        WHERE incolor = 'N'
        AND studioname = m.studioname)
    > (SELECT MAX(length)
        FROM Movie);
```
Втората вложена заявка не е обвързана (некорелираща) със студиото.
- Лявата част на сравнението е вярна: Първата вложена заявка (SELECT SUM(length) ...) е корелираща. За всеки филм m от външната заявка, тя правилно изчислява сумарната дължина на черно-белите филми за конкретното студио (studioname = m.studioname).
- Дясната част на сравнението е грешна: Втората вложена заявка (SELECT MAX(length) FROM Movie) е некорелираща. Тя изчислява максималната дължина на филм от цялата таблица Movie, а не за конкретното студио, което се проверява в момента.

за А)
```sql
   SELECT name
   FROM Studio
   LEFT JOIN Movie
      ON name = studioname
     AND incolor = 'N'
   GROUP BY name
   HAVING SUM(length) > MAX(length);
```
Основна грешка: MAX(length) се изчислява върху грешен набор от данни.
- HAVING SUM(length) > MAX(length): Тази проверка се извършва след групирането.
    - SUM(length) правилно сумира дължините на черно-белите филми.
    - MAX(length) обаче намира максимума само измежду същите тези черно-бели филми, тъй като цветните филми са били филтрирани още при JOIN-а.

За Б) Основна грешка: Синтактична грешка. Не може да се използват агрегатни функции в WHERE клауза.